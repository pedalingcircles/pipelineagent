# variables-version-semantic.yml
#
# Description: 
#   Variable template that can be included in Azure DevOps pipelines
#   to generate a Semantic Version. For Semantic Versioning details
#   see: https://semver.org
#
#   Include this template in any pipeline to generate a proper
#   semantic version and then leverage the versionSemantic variable
#   to set in any of the subsequent pipeline tasks. 
#
#   This template can be added at the pipeline, stage, or jobs level.
#   For information on how to include variable templates
#   see: https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops#variable-reuse
#
#   Semantic Version metadata is not supported in this template due to not being supported by the Shared Image Gallery.
#   Semantic version pre-release is not supported in this template due to not being supported by the Shared Image Gallery.
#
# Parameters:
#   versionMajor: number
#     The MAJOR value in Semantic Versioning. 
#     Version when you make incompatible API changes.
#     see: https://semver.org/#spec-item-4
#   versionMinor: number
#     The MINOR value in Semantic Versioning. 
#     Version when you add API functionality in a backwards compatible manner.
#     see: https://semver.org/#spec-item-7
#
# Variables:
#   versionPatch
#     The patch version value of Semantic Versioning.
#     This values is automatically set.
#     see: https://semver.org/#spec-item-6
#   versionPreRelease
#     The pre-release version valus of Semantic Versioning.
#     This values is set to '-beta' when builds are 
#     run on non long running branches. i.e. not master.
#     see: https://semver.org/#spec-item-9
#   versionSemantic
#     The full Semantic Version of this build.
#     see: https://semver.org

parameters: 
- name: versionMajor
  type: number
- name: versionMinor
  type: number
    
variables:
- name: versionPatch
  value: $[counter(format('{0}.{1}', '${{ parameters.versionMajor }}', '${{ parameters.versionMinor }}'), 0)]

- name: versionSemantic
  value: $[format('{0}.{1}.{2}', '${{ parameters.versionMajor }}', '${{ parameters.versionMinor }}', variables['versionPatch'])]


